# Интеграционные тесты

Интеграционные тесты проверяют код, связывающий доменную модель с внепроцессными зависимостями. Юнит-тесты покрывают алгоритмы и доменную модель. 
Важно поддерживать баланс между юнит- и интеграционными тестами. Работа напрямую с внепроцессорными зависимостями замедляет интеграционные тесты.

Проверяйте как можно больше пограничных случаев бизнес-сценария юнит-тестами. 
Используйте интеграционные тесты для покрытия одного позитивного пути, а так же всех пограничных случаев, которые не могут быть покрыты юнит-тестами.

Используйте реальные экземпляры управляемых зависимостей (например: база данных) в интеграционных тестах; заменяйте неуправляемые зависимости (например: SMTP-сервер) моками.

Интеграционный тест должен пройти через все уровни, работающие с управляемой зависимостью.
В примере с базой данных это означает проверку состояния базы данных независимо от данных, используемых во входных параметрах.

## Общие рекомендации

Эффективно использовать интеграционные тесты возможно в системе где:
- явно определены границы модели предметной области;
- минимально количество слоев;
- отсутствуют циклические зависимости;
- определены интерфейсы для неуправляемых зависимостей.

Четкая граница между классами предметной области и контроллерами помогает отличать юнит-тесты от интеграционных.

Всегда явно внедряйте все зависимости - либо через конструктор, либо через аргументы метода.

## Полезные ресурсы
[Сергей Егоров — TestContainers — интеграционное тестирование с Docker](https://youtu.be/PEVVvZOt7bY?si=7n3YSuTo6k38aiQU)  
[Testcontainers for Java](https://java.testcontainers.org/)  
[Testcontainers for Java / Files and volumes](https://java.testcontainers.org/features/files/)  